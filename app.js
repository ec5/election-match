!function(){"use strict";var e="undefined"==typeof window?global:window;if("function"!=typeof e.require){var t={},n={},a={},r={}.hasOwnProperty,l=/^\.\.?(\/|$)/,o=function(e,t){for(var n,a=[],r=(l.test(t)?e+"/"+t:t).split("/"),o=0,u=r.length;u>o;o++)n=r[o],".."===n?a.pop():"."!==n&&""!==n&&a.push(n);return a.join("/")},u=function(e){return e.split("/").slice(0,-1).join("/")},i=function(t){return function(n){var a=o(u(t),n);return e.require(a,t)}},c=function(e,t){var a=null;a=h&&h.createHot(e);var r={id:e,exports:{},hot:a};return n[e]=r,t(r.exports,i(e),r),r.exports},s=function(e){return a[e]?s(a[e]):e},f=function(e,t){return s(o(u(e),t))},d=function(e,a){null==a&&(a="/");var l=s(e);if(r.call(n,l))return n[l].exports;if(r.call(t,l))return c(l,t[l]);throw new Error("Cannot find module '"+e+"' from '"+a+"'")};d.alias=function(e,t){a[t]=e};var m=/\.[^.\/]+$/,p=/\/index(\.[^\/]+)?$/,v=function(e){if(m.test(e)){var t=e.replace(m,"");r.call(a,t)&&a[t].replace(m,"")!==t+"/index"||(a[t]=e)}if(p.test(e)){var n=e.replace(p,"");r.call(a,n)||(a[n]=e)}};d.register=d.define=function(e,a){if("object"==typeof e)for(var l in e)r.call(e,l)&&d.register(l,e[l]);else t[e]=a,delete n[e],v(e)},d.list=function(){var e=[];for(var n in t)r.call(t,n)&&e.push(n);return e};var h=e._hmr&&new e._hmr(f,d,t,n);d._cache=n,d.hmr=h&&h.wrap,d.brunch=!0,e.require=d}}(),function(){var e;window;require.register("initialize.js",function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){var n=[],a=!0,r=!1,l=void 0;try{for(var o,u=e[Symbol.iterator]();!(a=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(i){r=!0,l=i}finally{try{!a&&u["return"]&&u["return"]()}finally{if(r)throw l}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f=t("url"),d=a(f),m=t("lodash"),p=a(m),v=t("base64-js"),h=a(v),g=t("fuse.js"),b=a(g),E=t("pako"),y=a(E),w=t("query-string"),S=a(w),x=t("copy-to-clipboard"),D=a(x),j=t("reselect"),T=t("react-dom"),_=t("react"),k=a(_),M=t("react-bootstrap/lib/Badge"),N=a(M),q=t("react-bootstrap/lib/Button"),O=a(q),C=t("react-bootstrap/lib/Clearfix"),A=a(C),P=t("react-bootstrap/lib/Collapse"),R=(a(P),t("react-bootstrap/lib/DropdownButton")),U=a(R),V=t("react-bootstrap/lib/FormControl"),Y=a(V),F=t("react-bootstrap/lib/FormGroup"),G=a(F),L=t("react-bootstrap/lib/Grid"),B=a(L),I=t("react-bootstrap/lib/InputGroup"),K=a(I),z=t("react-bootstrap/lib/MenuItem"),H=a(z),J=t("react-bootstrap/lib/Nav"),W=a(J),X=t("react-bootstrap/lib/Navbar"),Q=a(X),Z=t("react-bootstrap/lib/NavItem"),ee=a(Z),te=t("react-bootstrap/lib/Panel"),ne=a(te),ae=t("react-list"),re=a(ae),le=t("react-scroll-up"),oe=a(le),ue=t("motion"),ie="googleClientLoaded",ce={yes:1,no:1,opposite:-1,novote:0},se=function(e){return h["default"].fromByteArray(y["default"].deflate(JSON.stringify({_v:1,data:e}),{level:9,memLevel:9}))},fe=function(e){try{return JSON.parse(y["default"].inflate(h["default"].toByteArray(e),{to:"string"}))}catch(t){return null}},de=function(e){var t=d["default"].parse(window.location.href);return delete t.search,t.hash="",t.query=e,d["default"].format(t)},me=function(){return p["default"].reduce(motionIds,function(e,t){return e[t]=null,e},{})},pe=function(){var e=p["default"].trimStart(window.location.hash,"#");switch(e){case"about":case"limitation":case"stats":return e;default:return"vote"}},ve=function(){var e=S["default"].parse(window.location.search),t=e.v,n=e.m,a={};if(t)a.voted=p["default"].get(fe(t),"data"),a.activeTab=Ce(a)?3:2;else if(n){var r=p["default"].get(fe(n),"data");a.voted=me(r),a.activeTab=2}return s({},a,{currentNav:pe()})},he=function(e,t){return p["default"].get(t,[e])},ge=function(e){return e.voted},be=function(e){return e.shortUrls},Ee=(0,j.createSelector)(ge,be,function(e,t){return de({m:se(p["default"].keys(e))})}),ye=(0,j.createSelector)(Ee,be,he),we=(0,j.createSelector)(ge,be,function(e,t){return de({v:se(e)})}),Se=(0,j.createSelector)(we,be,he),xe=(0,j.createSelector)(ge,we,function(e,t){return!p["default"].isEmpty(e)&&p["default"].size(t)<2048}),De=(0,j.createSelector)(function(e){return e.data.motions},function(e){return new b["default"](p["default"].values(e),{keys:["title"]})}),je=(0,j.createSelector)(function(e){return e.data.motions},function(e){return e.startDate},function(e){return e.endDate},function(e){return e.filterText},De,function(e,t,n,a,r){var l=p["default"].isEmpty(a)?e:r.search(a),o=p["default"].filter(l,function(e){return e.voteDateMoment.isBetween(t,n)});return o}),Te=(0,j.createSelector)(function(e){return e.data.motions},ge,function(e,t){return p["default"].filter(e,function(e){return!p["default"].isUndefined(p["default"].get(t,[e.id]))})}),_e=function(e){return{yes:"no",no:"yes"}[e]},ke=(0,j.createSelector)(function(e){return e.data.motions},ge,function(e){return e.data.members},function(e,t,n){return p["default"].sortBy(p["default"].map(n,function(e,n){var a=p["default"].reduce(t,function(t,n,a){var r=e.votes[a];return r===n?(t.score+=ce[n],t[n]+=1):r===_e(n)?(t.score+=ce.opposite,t.opposite+=1):r&&(t.score+=ce.novote,t.novote+=1,t[r]+=1),t},{yes:0,no:0,opposite:0,novote:0,absent:0,present:0,abstain:0,score:0});return{name:n,matching:a}}),function(e){return-1*e.matching.score})}),Me=(0,j.createSelector)(function(e){return e.data.motions},function(e){return p["default"].map(e,"voteDateMoment")}),Ne=(0,j.createSelector)(Me,function(e){return p["default"].max(e)}),qe=(0,j.createSelector)(Me,function(e){return p["default"].min(e)}),Oe=(0,j.createSelector)(ge,function(e){return p["default"].size(e)}),Ce=(0,j.createSelector)(ge,function(e){return p["default"].every(e,Boolean)}),Ae=function(e){function t(){return l(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return u(t,e),c(t,[{key:"componentDidMount",value:function(){$(this._input).daterangepicker(s({autoApply:!0,locale:{format:ue.DATE_FORMAT},showDropdowns:!0},p["default"].pick(this.props,["startDate","endDate","minDate","maxDate"]))).on("change",this.props.onChange)}},{key:"render",value:function(){var e=this;return k["default"].createElement("input",{ref:function(t){return e._input=t},type:"text",name:"datefilter",className:"form-control"})}}]),t}(_.Component),Pe=function(e){var t=e.onClick;return k["default"].createElement("button",{type:"button",className:"close pull-right",ariaLabel:"Close",onClick:t},k["default"].createElement("span",{ariaHidden:"true"},"×"))},Re=function(e){var t=e.motion,n=(0,ue.getUrls)(t);return k["default"].createElement(U["default"],{bsStyle:"link",title:t.voteDate,id:"vote-date-dropdown-"+t.id,style:{paddingLeft:0,paddingRight:0}},p["default"].reduce([["agenda","會議議程"],["rundown","會議過程正式紀錄"],["minutesPdf","會議紀要 PDF"],["results","決定的紀錄"],["votingPdf","投票結果 PDF"],["votingResults","投票結果"]],function(e,t,a){var r=i(t,2),l=r[0],o=r[1],u=n[l];return u&&e.push(k["default"].createElement(H["default"],{key:a,href:u,rel:"nofollow",target:"_blank"},o)),e},[]),k["default"].createElement(H["default"],{divider:!0}),k["default"].createElement(H["default"],{href:n.index,rel:"nofollow",target:"_blank"},"會議"))},Ue=function(e){var t=e.motions,n=e.voted,a=e.onVoteYes,r=e.onVoteNo,l=e.onRemoveMotion;return function(e){var o=t[e];return k["default"].createElement("div",{key:e,className:"form-group list-group-item lead"},k["default"].createElement("h4",{className:"list-group-item-heading"},k["default"].createElement(A["default"],{style:{margin:"0.5rem 0 1.5rem"}},p["default"].has(n,o.id)&&k["default"].createElement(Pe,{onClick:function(){return l(o.id)}}),k["default"].createElement(Re,{motion:o})),o.title),k["default"].createElement("label",{className:"radio-inline"},k["default"].createElement("input",{type:"radio",name:o.id,value:"yes",onChange:function(){return a(o)},checked:"yes"===p["default"].get(n,o.id)})," 贊成"),k["default"].createElement("label",{className:"radio-inline"},k["default"].createElement("input",{type:"radio",name:o.id,value:"no",onChange:function(){return r(o)},checked:"no"===p["default"].get(n,o.id)})," 反對"))}},Ve=function(e){var t=e.activeTab,n=e.onSelectTab,a=e.votedCount,r=e.isAllVoted,l=a>0&&r;return k["default"].createElement("header",null,k["default"].createElement("h2",null,"議案投票"),k["default"].createElement("p",{className:"lead"},"假如你是立法會議員，你會如何投票？"),k["default"].createElement(W["default"],{bsStyle:"tabs",activeKey:t,onSelect:n,justified:!0},k["default"].createElement(ee["default"],{eventKey:1},"選取議案"),k["default"].createElement(ee["default"],{eventKey:2,disabled:0===a},"你的投票"," ",k["default"].createElement(N["default"],{className:l?"alert-success":""},a)),k["default"].createElement(ee["default"],{eventKey:3,disabled:!l},"配對結果")))},Ye=function(e){try{(0,D["default"])(e)}catch(t){}},Fe=function(e){var t=e.url,n=e.shortUrl,a=e.onGenerateShortUrl;return k["default"].createElement("form",{onSubmit:function(e){e.preventDefault(),n?Ye(n):a(t,function(e){Ye(e.shortUrl)})}},k["default"].createElement(G["default"],null,k["default"].createElement(K["default"],null,k["default"].createElement(Y["default"],{type:"text",value:n||t,readOnly:!0,style:{textOverflow:"ellipsis"}}),k["default"].createElement(K["default"].Button,null,k["default"].createElement(O["default"],{type:"submit"},"複製短網址")))))},Ge=function(e){var t=e.currentNav;return k["default"].createElement(Q["default"],{staticTop:!0},k["default"].createElement(Q["default"].Header,null,k["default"].createElement(Q["default"].Brand,{active:!0},k["default"].createElement("a",{href:"#"},"立法會投票傾向配對")),k["default"].createElement(Q["default"].Toggle,null)),k["default"].createElement(Q["default"].Collapse,null,k["default"].createElement(W["default"],null,p["default"].map([["vote","議案投票"],["limitation","注意事項"],["about","關於本網"]],function(e,n){var a=i(e,2),r=a[0],l=a[1];return k["default"].createElement(ee["default"],{key:n,eventKey:r,href:"#"+r,active:t===r},l)}))))},Le=function(){return k["default"].createElement("section",{className:"container"},k["default"].createElement("h2",null,"注意事項"),k["default"].createElement("p",{className:"lead"},"一如所有的評分機制很難做到全面客觀，依賴一至數項的數據分析結果，不宜作為",k["default"].createElement("strong",null,"唯一"),"的投票依據。本網雖已儘量做得客觀，始終也有局限，在閱讀結果時應多加留意，不要盲目接受。"),k["default"].createElement("ul",null,k["default"].createElement("li",null,"由於本網只有 2012 年至今的投票結果，對於2012 年以前的議員或新進的參選人無法作出分析。"),k["default"].createElement("li",null,"議員可能因為一些原因沒有投票，因此在投票數量比其他人少的情況下，「配對結果」的排序或會因而降低。例如：",k["default"].createElement("ul",null,k["default"].createElement("li",null,"立法會主席或會議主持人很少會投票。"),k["default"].createElement("li",null,"未完成任期或補選的議員。")))))},Be=function(){return k["default"].createElement("section",{className:"container"},k["default"].createElement("h2",null,"關於本網"),k["default"].createElement("p",{className:"lead"},"本網旨在透過數據分析，為選民提供多一項投票時的參考指標，從而希望選出最具代表性的議員。"),k["default"].createElement("p",{className:"lead"},"本網所用之投票資料來自",k["default"].createElement("a",{href:"http://www.legco.gov.hk/general/chinese/open-legco/open-data.html",rel:"nofollow",target:"_blank"},"立法會網站"),"， 數據及源碼皆於 ",k["default"].createElement("a",{href:"https://github.com/ec5/election-match/",rel:"nofollow",target:"_blank"},"Github 上公開"),"， 歡迎指正錯漏或提出意見。"))},Ie=function(e){function t(e){l(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.renderFilterVotesTab=function(){var e=n.state,t=e.data,a=e.voted,r=e.startDate,l=e.endDate,o=je(n.state);return k["default"].createElement(ne["default"],null,k["default"].createElement("p",{className:"lead"},"共 ",p["default"].size(t.motions)," 個議案，最近更新：",Ne(n.state).format(ue.DATE_FORMAT),"。"),k["default"].createElement(Ae,{minDate:qe(n.state),maxDate:Ne(n.state),startDate:r,endDate:l,onChange:function(e,t){var a=p["default"].map(p["default"].split(e.target.value," - "),function(e){return moment(e,ue.DATE_FORMAT)}),r=i(a,2),l=r[0],o=r[1];n.setState({startDate:l,endDate:o})}}),k["default"].createElement(Y["default"],{type:"text",placeholder:"輸入關鍵字篩選",value:n.state.filterText,onChange:function(e){return n.setState({filterText:e.target.value})}}),p["default"].isEmpty(o)?k["default"].createElement("p",{className:"text-warning"},"沒有議案可投票"):k["default"].createElement(re["default"],{itemRenderer:Ue({motions:o,voted:a,onVoteYes:n.onVote("yes"),onVoteNo:n.onVote("no"),onRemoveMotion:n.onRemoveMotion}),length:o.length,type:"simple"}))},n.renderSelectedVotesTab=function(){var e=n.state.voted,t=Te(n.state);return k["default"].createElement("div",null,xe(n.state)&&k["default"].createElement(Fe,{url:Ee(n.state),shortUrl:ye(n.state),onGenerateShortUrl:n.onGenerateShortUrl}),p["default"].isEmpty(t)?k["default"].createElement("p",{className:"text-warning"},"未有投票"):k["default"].createElement(re["default"],{itemRenderer:Ue({motions:t,voted:e,onVoteYes:n.onVote("yes"),onVoteNo:n.onVote("no"),onRemoveMotion:n.onRemoveMotion}),length:t.length,type:"simple"}))},n.renderResultTab=function(){var e=ke(n.state);return k["default"].createElement("div",{className:"table-responsive"},xe(n.state)&&k["default"].createElement(Fe,{url:we(n.state),shortUrl:Se(n.state),onGenerateShortUrl:n.onGenerateShortUrl}),k["default"].createElement("table",{className:"table table-striped table-hover table-condensed"},k["default"].createElement("thead",null,k["default"].createElement("tr",null,k["default"].createElement("th",null,"議員"),k["default"].createElement("th",null,"相似分數"),k["default"].createElement("th",null,"相同投票"),k["default"].createElement("th",null,"相反投票"),k["default"].createElement("th",null,"相同贊成"),k["default"].createElement("th",null,"相同反對"),k["default"].createElement("th",null,"沒有表態"))),k["default"].createElement("tbody",null,p["default"].map(e,function(e,t){return k["default"].createElement("tr",{key:t},k["default"].createElement("td",null,e.name),k["default"].createElement("td",null,e.matching.score),k["default"].createElement("td",null,e.matching.yes+e.matching.no),k["default"].createElement("td",null,e.matching.opposite),k["default"].createElement("td",null,e.matching.yes),k["default"].createElement("td",null,e.matching.no),k["default"].createElement("td",null,e.matching.novote))}))))},n.onGenerateShortUrl=function(e,t){gapi.client.urlshortener.url.insert({resource:{longUrl:e}}).execute(function(a){var l=a.id;if(l){var o=n.state.shortUrls;n.setState({shortUrls:s({},o,r({},e,l))}),p["default"].isFunction(t)&&t({shortUrl:l})}})},n.onRemoveMotion=function(e){var t=p["default"].omit(n.state.voted,e);n.setState({voted:t,activeTab:p["default"].isEmpty(t)?1:n.state.activeTab})},n.state=s({activeTab:1,filterText:"",isGoogleClientLoaded:!1},ve()),n}return u(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this;$(window).on(ie,function(){e.setState({isGoogleClientLoaded:!0})}).on("hashchange",function(t){e.setState({currentNav:pe()})}),$.getJSON("data.json",function(t){p["default"].each(t.motions,function(e,t){e.id=t,e.group=e.meetingType+" - "+e.voteDate,e.voteDateMoment=moment(e.voteDate,ue.DATE_FORMAT)}),e.setState({data:t,startDate:qe({data:t}),endDate:Ne({data:t})})})}},{key:"render",value:function(){var e=this.state,t=e.currentNav,n=e.data;return n?k["default"].createElement("div",null,k["default"].createElement(Ge,{currentNav:t}),{vote:this.renderMainSection,stats:this.renderStatsSection,limitation:this.renderLimitationSection,about:this.renderAboutSection}[t].call(this),k["default"].createElement(oe["default"],{showUnder:160},k["default"].createElement("span",null,"移至頂部"))):k["default"].createElement("div",null,"載入議案資料中⋯⋯")}},{key:"renderMainSection",value:function(){var e=this,t=this.state,n=(t.data,t.activeTab);t.voted;return k["default"].createElement(B["default"],null,k["default"].createElement(Ve,{activeTab:n,onSelectTab:function(t){return e.setState({activeTab:t})},votedCount:Oe(this.state),isAllVoted:Ce(this.state)}),[this.renderFilterVotesTab,this.renderSelectedVotesTab,this.renderResultTab][n-1].call(this))}},{key:"renderStatsSection",value:function(){return k["default"].createElement("div",null,"stats")}},{key:"renderLimitationSection",value:function(){return k["default"].createElement(Le,null)}},{key:"renderAboutSection",value:function(){return k["default"].createElement(Be,null)}},{key:"onVote",value:function(e){var t=this;return function(n){var a=t.state.voted;t.setState({voted:s({},a,r({},n.id,e))})}}}]),t}(k["default"].Component),Ke=function(){var e="AIzaSyA8f91lvLDPchAInQKcjWX4LXjAiJbDEHo";gapi.client.setApiKey(e),gapi.client.load("urlshortener","v1",function(){$(window).trigger(ie)})};window.initGoogleClient=Ke,document.addEventListener("DOMContentLoaded",function(){(0,T.render)(k["default"].createElement(Ie,null),document.getElementById("app"))})}),require.register("motion.js",function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(e,"__esModule",{value:!0}),e.getUrls=e.DATE_FORMAT=void 0;var r=t("lodash"),l=a(r),o=e.DATE_FORMAT="DD/MM/YYYY";e.getUrls=function(e){var t=e.meetingType,n=e.startDate,a=e.voteDateMoment,r=moment(n,o),u=(r.month()>=9?r.year():r.year()-1)%100,i=u+"-"+(u+1),c="http://www.legco.gov.hk/yr"+i+"/chinese/",s=r.format("YYYYMMDD"),f={"Council Meeting":{urls:{index:"http://www.legco.gov.hk/general/chinese/counmtg/yr12-16/mtg_"+u+(u+1)+".htm",agenda:c+"counmtg/agenda/cm"+s+".htm",minutesPdf:c+"counmtg/minutes/cm"+s+".pdf",votingPdf:c+"counmtg/voting/v"+s+".pdf",rundown:"http://www.legco.gov.hk/php/hansard/chinese/rundown.php?date="+a.format("YYYY-MM-DD")+"&lang=1"}},"Establishment Subcommittee":{index:"fc/esc/general/meetings.htm",code:"esc",prefix:c+"fc/esc",props:["agenda","minutesPdf"]},"Finance Committee":{index:"fc/fc/general/meetings.htm",code:"fc",prefix:c+"fc/fc",props:["agenda","minutesPdf","results","votingResults"]},"House Committee":{index:"hc/general/hc_mtg.htm",code:"hc",prefix:c+"hc",props:["agenda","minutesPdf"]},"Public Works Subcommittee":{index:"fc/pwsc/general/meetings.htm",code:"pwsc",prefix:c+"fc/pwsc",props:["agenda","minutesPdf","results"]}}[t];if(f.urls)return f.urls;var d=l["default"].pick({agenda:f.prefix+"/agenda/"+f.code+s+".htm",minutesPdf:f.prefix+"/minutes/"+f.code+s+".pdf",results:f.prefix+"/results/"+f.code+s+".htm",votingPdf:f.prefix+"/voting/v"+s+".pdf",votingResults:f.prefix+"/results/v"+s+".htm"},f.props);return d.index=""+f.prefix+f.index,d}}),require.alias("lodash/lodash.js","lodash"),require.alias("process/browser.js","process"),require.alias("url/url.js","url"),require.alias("base64-js/lib/b64.js","base64-js"),require.alias("fuse.js/src/fuse.js","fuse.js"),require.alias("reselect/lib/index.js","reselect"),require.alias("react-bootstrap/lib/index.js","react-bootstrap"),require.alias("react/react.js","react"),require.alias("react-list/react-list.js","react-list"),require.alias("punycode/punycode.js","punycode"),require.alias("performance-now/lib/performance-now.js","performance-now"),require.alias("react-prop-types/lib/index.js","react-prop-types"),require.alias("warning/browser.js","warning"),require.alias("react-overlays/lib/index.js","react-overlays"),require.alias("invariant/browser.js","invariant"),require.alias("buffer/index.js","buffer"),require.alias("querystring-es3/index.js","querystring"),e=require("process"),require.register("___globals___",function(e,t,n){})}(),require("___globals___");